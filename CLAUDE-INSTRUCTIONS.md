# Claude Instructions for Masumi Documentation Project

## CRITICAL FUMADOCS RULE
**ALWAYS add new files to meta.json navigation** - This is how Fumadocs works. Any new content file must be added to the appropriate `meta.json` file or it won't appear in the navigation.

## Project Overview
This is the Masumi documentation site built with Fumadocs. It automatically syncs content from various GitHub repositories and includes MIPs (Masumi Improvement Proposals).

## Key Directories and Files

### Content Structure
```
content/docs/
├── documentation/          # Technical documentation
├── mips/                  # Masumi Improvement Proposals
│   ├── meta.json         # MIPs navigation config
│   ├── index.mdx         # MIPs overview
│   ├── _mip-001.mdx      # Individual MIPs
│   └── ...
└── n8n-node/             # N8N node documentation
```

### Scripts
- `/scripts/fetch-readme.mjs` - Syncs content from GitHub repositories
- Run with: `node scripts/fetch-readme.mjs`

### Configuration
- Each directory with content must have a `meta.json` file defining navigation
- `meta.json` structure:
  ```json
  {
    "title": "Section Title",
    "icon": "IconName",
    "pages": ["file1", "file2", "file3"]
  }
  ```

## Essential Rules

### 1. File Addition Process
When adding ANY new content file:
1. Create the `.mdx` file in the appropriate directory
2. **IMMEDIATELY** add it to the corresponding `meta.json` file
3. Place it in logical order within the pages array
4. Test navigation works: `npm run dev`

### 2. File Naming Conventions
- **ALL synced files MUST start with underscore `_`**
- MIPs: `_mip-XXX.mdx` (underscore prefix for main MIPs)
- MIP attachments: `_mip-XXX-attachment-YY.mdx` (underscore prefix)
- All other synced content: `_filename.mdx` (underscore prefix)
- Only manually created files can omit the underscore

### 3. Content Syncing
- The fetch script automatically updates content from GitHub
- Always run after making changes to fetch script: `node scripts/fetch-readme.mjs`
- Verify builds work: `npm run build`

### 4. Link Transformations
- GitHub relative links need transformation for local site
- MIPs have special link transformation in fetch script
- MIP-003 attachment links are automatically transformed

## Common Tasks

### Adding a New MIP
1. Add entry to `/scripts/fetch-readme.mjs` REPOS array
2. Run `node scripts/fetch-readme.mjs`
3. **CRITICAL**: Add to `/content/docs/mips/meta.json`
4. Test: `npm run dev`

### Adding MIP Attachments
1. Add attachment entry to fetch script REPOS array
2. Add link transformation function if needed
3. Apply transformation in processing pipeline
4. **CRITICAL**: Add to `/content/docs/mips/meta.json`
5. Update main MIP file links if necessary

### Updating Documentation
1. Modify fetch script configuration if needed
2. Run `node scripts/fetch-readme.mjs`
3. Check all files generated correctly
4. Verify navigation works
5. Test build: `npm run build`

## Troubleshooting

### File Not Appearing in Navigation
- Check if added to appropriate `meta.json`
- Verify file name matches entry in meta.json exactly
- Restart dev server: `npm run dev`

### Build Failures
- Check for malformed frontmatter in MDX files
- Verify all imports are correct
- Check for broken internal links
- Run: `npm run build` to see specific errors

### Content Not Updating
- Re-run fetch script: `node scripts/fetch-readme.mjs`
- Check GitHub source files exist
- Verify fetch script configuration
- Clear cache and restart: `npm run dev`

## Important Files to Never Modify Manually
These are auto-generated by the fetch script:
- `/content/docs/mips/_mip-*.mdx` (except meta.json)
- `/content/docs/documentation/get-started/_agentic-service-wrapper.mdx`
- Other files configured in fetch script REPOS array

## Testing Workflow
1. Make changes
2. Run fetch script if needed: `node scripts/fetch-readme.mjs`
3. Check dev server: `npm run dev`
4. Test build: `npm run build`
5. Verify navigation and links work

## Meta.json Examples

### Basic structure:
```json
{
  "title": "Documentation",
  "pages": ["index", "file1", "file2"]
}
```

### With icons and nested structure:
```json
{
  "title": "MIPs",
  "icon": "FileText",
  "root": true,
  "pages": [
    "index",
    "_mip-001",
    "_mip-002",
    "_mip-003",
    "mip-003-attachment-01",
    "_mip-004"
  ]
}
```

## Remember
- **ALWAYS update meta.json when adding files**
- Test navigation after any changes
- Run build to catch errors early
- Keep logical ordering in navigation
- Use consistent naming conventions